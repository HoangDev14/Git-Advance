A master update
A from thientq



A change from branch2